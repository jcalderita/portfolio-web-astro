---
import BlogLayout from "@layouts/BlogLayout.astro";
import BlogCard from "./BlogCard.astro";
import TagButton from "./TagButton.astro";
import TagFilter from "./TagFilter.astro";
import RSSLink from "./RSSLink.astro";
import { getPosts } from "@utils/blogData";

interface Props {
    language: string;
}

const { language } = Astro.props;
const posts = await getPosts(language);

posts.sort((a, b) => b.data.date.getTime() - a.data.date.getTime());
const allTags = Array.from(new Set(posts.flatMap((post) => post.data.tags)));
---

<style>
    @import "tailwindcss" reference;

    .tagButtons {
        @apply flex flex-wrap gap-2 mb-8 items-center;
    }

    .postList {
        @apply grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6;
    }
</style>

<BlogLayout language={language} title="Blog">
    <div class="tagButtons">
        <TagButton language={language} tag="all" />
        {allTags.map((tag) => <TagButton language={language} tag={tag} />)}
        <RSSLink language={language} />
    </div>
    <div id="posts-list" class="postList">
        {posts.map((post) => <BlogCard language={language} post={post} />)}
    </div>
    <TagFilter />
</BlogLayout>
