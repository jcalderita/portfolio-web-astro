---
title: "Timestamps en Migraciones"
slug: "timestamps-migrations-es"
date: 2025-09-15
author: "Jorge Calderita"
description: "Cómo evitar repetir createdAt, updatedAt y deletedAt en las migraciones de base de datos usando extensiones."
tags: ["Swift", "Vapor"]
cover: "../images/Timestamps.png"
publicCover: "Timestamps.webp"
coverDescription: "Jorge escribiendo con una mano en una pizarra 1000 veces, createdAt, updatedAt y deletedAt. Con la otra mano mientras tanto programa."
publish: true
---
---

## Timestamps

Si eres como yo, cuando diseñas un modelo de base de datos quieres que todas las tablas incluyan siempre tres campos clave: 
* <span class="high">createdAt</span>: indica cuándo se creó el registro.
* <span class="high">updatedAt</span>: refleja la última vez que se actualizó.
* <span class="high">deletedAt</span>: marca cuándo se eliminó de forma lógica (sin borrar físicamente el registro).

---

## Problema

Como se puede observar, en cada migración tenemos que escribir manualmente los tres campos de timestamp. Esto no solo es repetitivo, sino que también es propenso a errores si olvidamos algún campo o escribimos mal el tipo de dato.

```swift
try await db.schema(model)
    .id()
    .field(.name, .string, .required)
    .field(.createdAt, .datetime, .required)
    .field(.updatedAt, .datetime, .required)
    .field(.deletedAt, .datetime)
    .create()
```

---

## Solución

La solución es crear una extensión de <span class="high">SchemaBuilder</span> que agregue un método <span class="high">timestamps()</span>. Esta extensión encapsula la lógica repetitiva en un solo lugar, haciendo el código más limpio y mantenible.

```swift
extension SchemaBuilder {
    func timestamps() -> Self {
        self.field(.createdAt, .datetime, .required)
            .field(.updatedAt, .datetime, .required)
            .field(.deletedAt, .datetime)
    }
}
```

---

## Resultado

Ahora nuestras migraciones son mucho más limpias y legibles. Llamando a <span class="high">.timestamps()</span> agregamos los tres campos necesarios. Esto reduce la posibilidad de errores y hace que el código sea más fácil de mantener.

```swift
try await db.schema(model)
    .id()
    .field(.name, .string, .required)
    .timestamps()
    .create()
```

---