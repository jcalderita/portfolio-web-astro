---
title: "Async Task List"
slug: "task-list-es"
date: 2025-11-20
author: "Jorge Calderita"
description: "Implementaci√≥n de un sistema robusto para la gesti√≥n de listas de tareas as√≠ncronas con persistencia de estado en base de datos utilizando Swift y Vapor."
tags: ["Swift", "Vapor"]
cover: "../images/TaskList.png"
publicCover: "TaskList.webp"
coverDescription: "Jorge participando en las distintas pruebas de una Decatl√≥n y checkeando las realizadas."
publish: true
---
---
## Problema

En sistemas distribuidos con microservicios, un proceso complejo puede generar dificultades de control y fiabilidad. Una soluci√≥n es **dividirlo** en tareas **at√≥micas**, lo que permite un control m√°s granular del **flujo**, mejorar la **observabilidad**, asegurar la **idempotencia** y facilitar la **recuperaci√≥n** ante fallos.

El reto es dise√±ar un patr√≥n que permita una **degradaci√≥n controlada**, de modo que el fallo de una tarea no afecte al flujo completo, garantizando **resiliencia** y **tolerancia a fallos** en entornos de producci√≥n.

---
## Soluci√≥n

Crear un <span class="high">task executor</span> que orquesta tareas as√≠ncronas.  
La funci√≥n <span class="high">execute</span> envuelve cada tarea, gestiona errores con <span class="high">do-catch</span> como <span class="high">circuit breaker</span>, actualiza el estado en caso de **√©xito**, registra y persiste los fallos, y asegura una **transacci√≥n at√≥mica** para mantener la consistencia de datos.

```swift
func execute(
    status: StatusEnum,
    process: ProcessModel,
    _ work: () async throws -> ProcessModel
) async throws {
    do {
        let job = try await work()
        process.setStatus(job.status)
    } catch {
        process.setError(type: status, message: "\(error)")
    }
    try await repo.updateProcess(process)
}
```

---
## Resultado

Esta implementaci√≥n ofrece una **abstracci√≥n de alto nivel** que permite una **orquestaci√≥n precisa** de procesos as√≠ncronos complejos con garant√≠as de **atomicidad** y **durabilidad**.

üéØ **Separation of Concerns:** cada tarea a√≠sla su contexto de ejecuci√≥n y su gesti√≥n de errores.  
üîÑ **Workflow Orchestration:** posibilita encadenar tareas mediante el pipeline pattern.  
üìä **Observability:** genera un audit trail completo para depuraci√≥n y monitorizaci√≥n.  
‚ö° **Performance:** mantiene alta concurrencia sin comprometer la consistencia de datos.  
üõ°Ô∏è **Resilience:** incorpora fail-fast y recovery patterns autom√°ticos.

```swift
try await execute(status: .loadImages, process: process) {
    // Your implementation
}
```

---
